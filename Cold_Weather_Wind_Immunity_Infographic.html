<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œíŒŒì™€ ê°•í’: ë©´ì—­ë ¥ì˜ ìƒê´€ê´€ê³„ ë¶„ì„</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Font: Noto Sans KR -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #F3F4F6; /* slate-100 */
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <header class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto px-6 py-12 text-center">
            <h1 class="text-3xl md:text-5xl font-black mb-4">ë°”ëŒì€ ì–´ë–»ê²Œ ë©´ì—­ë ¥ì„ ë¬´ë„ˆëœ¨ë¦¬ëŠ”ê°€?</h1>
            <p class="text-xl md:text-2xl font-light opacity-90">ë‹¨ìˆœ ì €ì˜¨ vs. ê°•í’ ë™ë°˜ ì €ì˜¨ì˜ ì‹ ì²´ ì˜í–¥ ë¹„êµ ë¶„ì„</p>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 space-y-12">

        <!-- Section 1 -->
        <section class="max-w-4xl mx-auto">
            <div class="bg-white rounded-xl shadow-md p-8 border-l-8 border-cyan-500">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">ì—°êµ¬ ë°°ê²½: ì²´ê° ì˜¨ë„ì˜ í•¨ì •</h2>
                <p class="text-lg leading-relaxed text-gray-600 mb-6">
                    ë§ì€ ì‚¬ëŒë“¤ì´ ë‹¨ìˆœíˆ ì˜¨ë„ê³„ì˜ ìˆ«ì(ê¸°ì˜¨)ì—ë§Œ ì§‘ì¤‘í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì¸ì²´ ë©´ì—­ë ¥ì— ì¹˜ëª…ì ì¸ ì˜í–¥ì„ ì£¼ëŠ” ê²ƒì€ 
                    í”¼ë¶€ í‘œë©´ì˜ ì—´ì„ ê¸‰ê²©íˆ ë¹¼ì•—ì•„ê°€ëŠ” <strong>'ë°”ëŒ'</strong>ì…ë‹ˆë‹¤. 
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                    <div class="bg-blue-50 p-6 rounded-lg text-center">
                        <span class="block text-gray-500 text-sm font-bold uppercase tracking-wider">ë‹¨ìˆœ ê¸°ì˜¨ í•˜ë½ ì‹œ (-5Â°C)</span>
                        <span class="block text-4xl font-black text-blue-600 mt-2">ì²´ì˜¨ ì†ì‹¤ ì†ë„ 1x</span>
                    </div>
                    <div class="bg-cyan-50 p-6 rounded-lg text-center border-2 border-cyan-100">
                        <span class="block text-gray-500 text-sm font-bold uppercase tracking-wider">ê°•í’ ë™ë°˜ ì‹œ (-5Â°C + 10m/s)</span>
                        <span class="block text-4xl font-black text-red-600 mt-2">ì²´ì˜¨ ì†ì‹¤ ì†ë„ 4.5x</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Wind Chill Chart -->
        <section>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
                <div class="lg:col-span-1">
                    <h3 class="text-2xl font-bold text-blue-800 mb-4 border-b-2 border-blue-200 pb-2">1. ìœˆë“œì¹ (Wind Chill) íš¨ê³¼ ë¶„ì„</h3>
                    <p class="text-gray-700 mb-4 text-sm leading-7">
                        ë°”ëŒì€ í”¼ë¶€ ì£¼ìœ„ë¥¼ ê°ì‹¸ê³  ìˆëŠ” ë”°ëœ»í•œ ê³µê¸°ì¸µì„ ë‚ ë ¤ë²„ë¦½ë‹ˆë‹¤. ë™ì¼í•œ ì˜í•˜ 5ë„ë¼ë„ ë°”ëŒì´ ë¶ˆë©´ ì²´ê° ì˜¨ë„ëŠ” ê¸‰ê²©íˆ ë–¨ì–´ì§‘ë‹ˆë‹¤.
                    </p>
                </div>
                <div class="lg:col-span-2 bg-white rounded-xl shadow-md p-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 text-center">í’ì† ì¦ê°€ì— ë”°ë¥¸ ì²´ê° ì˜¨ë„ ë³€í™” ì¶”ì´</h4>
                    <div class="chart-container max-w-2xl mx-auto">
                        <canvas id="windChillChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Immunity Chart -->
        <section>
            <div class="bg-white rounded-xl shadow-md p-8">
                <div class="mb-6 text-center max-w-2xl mx-auto">
                    <h3 class="text-2xl font-bold text-red-700 mb-2">2. ê·¹í•œ í™˜ê²½ì—ì„œì˜ ë©´ì—­ ì„¸í¬ í™œì„±ë„</h3>
                    <p class="text-gray-600">ê°•í’ì€ ì ë§‰ì„ ê±´ì¡°ì‹œì¼œ ë°©ì–´ë§‰ì„ ì·¨ì•½í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div class="chart-container">
                        <canvas id="immunityBarChart"></canvas>
                    </div>
                    <div class="space-y-4">
                        <div class="flex items-start p-4 bg-gray-50 rounded-lg">
                            <div class="text-3xl mr-4">ğŸŒ¡ï¸</div>
                            <div>
                                <h4 class="font-bold text-gray-800">ë‹¨ìˆœ ì €ì˜¨ (Cold Only)</h4>
                                <p class="text-sm text-gray-600">ë©´ì—­ ì„¸í¬ í™œì„±ë„ ì•½ 70% ìœ ì§€.</p>
                            </div>
                        </div>
                        <div class="flex items-start p-4 bg-red-50 border border-red-100 rounded-lg">
                            <div class="text-3xl mr-4">ğŸŒ¬ï¸</div>
                            <div>
                                <h4 class="font-bold text-red-700">ì €ì˜¨ + ê°•í’ (Cold + Wind)</h4>
                                <p class="text-sm text-gray-700">ë©´ì—­ ì„¸í¬ í™œì„±ë„ 40% ë¯¸ë§Œ ê¸‰ë½.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Risk Heatmap -->
        <section>
            <div class="grid grid-cols-1 gap-8">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                        <h3 class="text-2xl font-bold text-gray-800">3. ê°ê¸°/ë…ê° ê°ì—¼ ìœ„í—˜ë„ íˆíŠ¸ë§µ</h3>
                        <span class="text-xs font-bold px-3 py-1 bg-red-100 text-red-600 rounded-full mt-2 md:mt-0">Plotly.js</span>
                    </div>
                    <div id="riskHeatmap" class="w-full h-[450px] border border-gray-100 rounded-lg"></div>
                </div>
            </div>
        </section>

        <!-- Gemini API Section (Configured for Hardcoded Key) -->
        <section class="max-w-4xl mx-auto">
            <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl shadow-lg p-8 border border-indigo-100">
                <div class="text-center mb-8">
                    <h3 class="text-3xl font-bold text-indigo-900 mb-2 flex justify-center items-center gap-2">
                        <span>âœ¨</span> AI ë§ì¶¤í˜• í•œíŒŒ ìœ„í—˜ë„ ë¶„ì„ê¸° <span>âœ¨</span>
                    </h3>
                    <p class="text-gray-600">í˜„ì¬ ë‚ ì”¨ì™€ í™œë™ ê³„íšì„ ì…ë ¥í•˜ì‹œë©´, AIê°€ ë§ì¶¤í˜• ê±´ê°• ì¡°ì–¸ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">í˜„ì¬ ê¸°ì˜¨ (Â°C)</label>
                        <input type="number" id="inputTemp" value="-5" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">í’ì† (m/s)</label>
                        <input type="number" id="inputWind" value="10" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">í™œë™ ìœ í˜•</label>
                        <select id="inputActivity" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                            <option value="ì¶œí‡´ê·¼/í†µí•™">ì¶œí‡´ê·¼/í†µí•™ (ê±·ê¸°)</option>
                            <option value="ì•¼ì™¸ ìš´ë™">ì•¼ì™¸ ìš´ë™ (ëŸ¬ë‹, ë“±ì‚°)</option>
                            <option value="ì•¼ì™¸ ì‘ì—…">ì•¼ì™¸ ì¥ì‹œê°„ ì‘ì—…</option>
                            <option value="ê°€ë²¼ìš´ ì‚°ì±…">ê°€ë²¼ìš´ ì‚°ì±…</option>
                        </select>
                    </div>
                </div>

                <button onclick="getGeminiAdvice()" id="btnGenerate" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-lg shadow-md transition-colors flex justify-center items-center gap-2">
                    <span>âœ¨ AI ì¡°ì–¸ ë°›ê¸°</span>
                </button>

                <div id="aiOutputContainer" class="hidden mt-8 bg-white p-6 rounded-lg border border-indigo-100 shadow-inner">
                    <h4 class="text-lg font-bold text-indigo-800 mb-4 border-b pb-2">Geminiì˜ ë¶„ì„ ê²°ê³¼</h4>
                    <div id="aiLoading" class="hidden text-center py-4">
                        <div class="loader mr-2"></div>
                        <span class="text-gray-500">ë¶„ì„ ì¤‘...</span>
                    </div>
                    <div id="aiResponse" class="prose prose-sm max-w-none text-gray-700 leading-relaxed"></div>
                </div>
            </div>
        </section>

        <!-- Section 5: Solutions -->
        <section class="max-w-5xl mx-auto">
            <h3 class="text-2xl font-bold text-center text-gray-800 mb-8">ëŒ€ì‘ ì „ëµ: 'ë°”ëŒ'ì„ ì°¨ë‹¨í•˜ë¼</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="relative bg-white p-6 rounded-xl shadow-sm border-t-4 border-blue-500">
                    <h4 class="text-center font-bold text-lg mt-2 mb-2">1. ë°©í’ ë ˆì´ì–´ë§</h4>
                    <p class="text-sm text-center text-gray-600">ê°€ì¥ ë°”ê¹¥ìª½ì—ëŠ” ë°˜ë“œì‹œ ë°”ëŒì„ ë§‰ëŠ” ì†Œì¬ ì°©ìš©.</p>
                </div>
                <div class="relative bg-white p-6 rounded-xl shadow-sm border-t-4 border-cyan-500">
                    <h4 class="text-center font-bold text-lg mt-2 mb-2">2. ì ë§‰ ìŠµë„ ìœ ì§€</h4>
                    <p class="text-sm text-center text-gray-600">ë§ˆìŠ¤í¬ ì°©ìš©ìœ¼ë¡œ ë‚´ì‰¬ëŠ” ìˆ¨ì˜ ìŠµê¸° ìœ ì§€.</p>
                </div>
                <div class="relative bg-white p-6 rounded-xl shadow-sm border-t-4 border-red-500">
                    <h4 class="text-center font-bold text-lg mt-2 mb-2">3. ë…¸ì¶œ ë¶€ìœ„ ìµœì†Œí™”</h4>
                    <p class="text-sm text-center text-gray-600">ëª©ë„ë¦¬, ì¥ê°‘ìœ¼ë¡œ í”¼ë¶€ ë…¸ì¶œ 0% ë„ì „.</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-gray-400 py-8 mt-12">
        <div class="container mx-auto px-6 text-center text-sm">
            <p>&copy; 2024 Health & Weather Analytics Lab. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // --- âš ï¸ ì¤‘ìš”: ì—¬ê¸°ì— ë³¸ì¸ì˜ API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš” âš ï¸ ---
        // êµ¬ê¸€ í´ë¼ìš°ë“œ ì½˜ì†”ì—ì„œ 'https://leestriker.github.io/HealthCare/*' ë¦¬í¼ëŸ¬ ì œí•œì„ ì„¤ì •í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
        const MY_GEMINI_API_KEY = "AIzaSyAPufdT1nLBdbNroo1bdmGB6foe6Nuxdng"; 

        // --- 1. Utilities ---
        function wrapLabel(str, maxChars = 16) {
            if (str.length <= maxChars) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];
            for (let i = 1; i < words.length; i++) {
                if (currentLine.length + 1 + words[i].length <= maxChars) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    padding: 12,
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            return Array.isArray(label) ? label.join(' ') : label;
                        }
                    }
                }
            }
        };

        // --- 2. Charts Initialization ---
        const ctxWind = document.getElementById('windChillChart').getContext('2d');
        const windLabels = ["0m/s (ì •ì§€)", "5m/s (ì•½í•œ ë°”ëŒ)", "10m/s (ê°•í•œ ë°”ëŒ)", "15m/s (ë§¤ìš° ê°•í•œ ë°”ëŒ)", "20m/s (íƒœí’ê¸‰)"];
        new Chart(ctxWind, {
            type: 'line',
            data: {
                labels: windLabels.map(l => wrapLabel(l, 16)),
                datasets: [
                    {
                        label: 'ì‹¤ì œ ê¸°ì˜¨ (-5Â°C)',
                        data: [-5, -5, -5, -5, -5],
                        borderColor: '#9CA3AF',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0
                    },
                    {
                        label: 'ì²´ê° ì˜¨ë„',
                        data: [-5, -9, -13, -16, -19],
                        borderColor: '#2563EB',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#DC2626',
                        fill: true
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: { y: { suggestedMin: -25, suggestedMax: 0 } }
            }
        });

        const ctxImmune = document.getElementById('immunityBarChart').getContext('2d');
        const immuneLabels = ["ì •ìƒ ì²´ì˜¨ (36.5Â°C)", "ë‹¨ìˆœ ê¸°ì˜¨ í•˜ë½ (-0.5Â°C)", "ê¸°ì˜¨ í•˜ë½ + ê°•í’ (-2Â°C)"];
        new Chart(ctxImmune, {
            type: 'bar',
            data: {
                labels: immuneLabels.map(l => wrapLabel(l, 18)),
                datasets: [{
                    label: 'ë©´ì—­ ì„¸í¬ í™œì„±ë„ (%)',
                    data: [100, 72, 38],
                    backgroundColor: ['#10B981', '#F59E0B', '#EF4444'],
                    borderRadius: 8
                }]
            },
            options: {
                ...commonOptions,
                plugins: { ...commonOptions.plugins, legend: { display: false } },
                scales: { y: { max: 100, beginAtZero: true } }
            }
        });

        // --- 3. Plotly Heatmap ---
        const dataPlotly = [{
            z: [[10, 25, 40, 55, 65], [30, 50, 65, 80, 85], [50, 70, 85, 95, 98], [70, 85, 95, 99, 100]],
            x: ["0 m/s", "5 m/s", "10 m/s", "15 m/s", "20 m/s"],
            y: ["0Â°C", "-5Â°C", "-10Â°C", "-15Â°C"],
            type: 'heatmap',
            colorscale: [[0, '#E0F2FE'], [0.4, '#FCD34D'], [0.7, '#F97316'], [1, '#DC2626']],
            hovertemplate: 'ê¸°ì˜¨: %{y}<br>í’ì†: %{x}<br><b>ìœ„í—˜ë„: %{z}%</b><extra></extra>'
        }];
        Plotly.newPlot('riskHeatmap', dataPlotly, {
            margin: { t: 30, l: 60, r: 30, b: 50 },
            xaxis: { title: 'í’ì†' },
            yaxis: { title: 'ê¸°ì˜¨' }
        }, { responsive: true, displayModeBar: false });

        // --- 4. Gemini API Call ---
        async function getGeminiAdvice() {
            const temp = document.getElementById('inputTemp').value;
            const wind = document.getElementById('inputWind').value;
            const activity = document.getElementById('inputActivity').value;
            
            const outputContainer = document.getElementById('aiOutputContainer');
            const loader = document.getElementById('aiLoading');
            const responseDiv = document.getElementById('aiResponse');
            
            // Validation
            if (MY_GEMINI_API_KEY.includes("YOUR_API_KEY") || MY_GEMINI_API_KEY.length < 10) {
                alert("GitHub Pagesì— ë°°í¬í•˜ê¸° ì „ì— index.html íŒŒì¼ì˜ MY_GEMINI_API_KEY ë³€ìˆ˜ì— ì‹¤ì œ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            outputContainer.classList.remove('hidden');
            loader.classList.remove('hidden');
            loader.classList.add('flex', 'justify-center', 'items-center');
            responseDiv.innerHTML = '';
            
            // Using standard model endpoint for general keys
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${MY_GEMINI_API_KEY}`;
            
            const prompt = `
                ë‹¹ì‹ ì€ í•œíŒŒ ë° ê±´ê°• ì•ˆì „ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
                ìƒí™©: ê¸°ì˜¨ ${temp}Â°C, í’ì† ${wind}m/s, í™œë™: ${activity}.
                ì´ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì²´ê° ì˜¨ë„ ì˜í–¥, í™œë™ ì‹œ ì£¼ì˜ì , ë³µì¥ ì¶”ì²œì„ í•œêµ­ì–´ë¡œ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì§§ê²Œ ì¡°ì–¸í•´ì£¼ì„¸ìš”.
            `;

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                if (!response.ok) throw new Error(response.status);
                const data = await response.json();
                const aiText = data.candidates[0].content.parts[0].text;
                
                responseDiv.innerHTML = aiText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>');

            } catch (error) {
                console.error(error);
                responseDiv.innerHTML = `<p class="text-red-600">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (Google Cloud Consoleì—ì„œ ë¦¬í¼ëŸ¬ ì œí•œ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”)</p>`;
            } finally {
                loader.classList.add('hidden');
                loader.classList.remove('flex');
            }
        }
    </script>
</body>
</html>